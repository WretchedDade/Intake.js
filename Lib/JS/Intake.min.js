/**
 * Author: Dade Cook
 * Codepen Demo: https://codepen.io/WretchedDade/pen/ZxNGjg
 * GitHub Repository: https://github.com/WretchedDade/Intake.js
 */
'use strict';var _get=function a(b,c,d){null===b&&(b=Function.prototype);var f=Object.getOwnPropertyDescriptor(b,c);if(f===void 0){var g=Object.getPrototypeOf(b);return null===g?void 0:a(g,c,d)}if('value'in f)return f.value;var h=f.get;return void 0===h?void 0:h.call(d)},_createClass=function(){function a(b,c){for(var f,d=0;d<c.length;d++)f=c[d],f.enumerable=f.enumerable||!1,f.configurable=!0,'value'in f&&(f.writable=!0),Object.defineProperty(b,f.key,f)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return b&&('object'==typeof b||'function'==typeof b)?b:a}function _inherits(a,b){if('function'!=typeof b&&null!==b)throw new TypeError('Super expression must either be null or a function, not '+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var Intake=function(){function a(b,c,d,f,g){var h=5<arguments.length&&void 0!==arguments[5]?arguments[5]:null;if(_classCallCheck(this,a),this.Container='string'==typeof b?document.querySelector(b):b,this.Container.classList.add('Intake-Container'),this.Container.setAttribute('tabindex',-1),this.Form='string'==typeof c?document.querySelector(c):c,this.HiddenInput='string'==typeof f?document.querySelector(f):f,!g)throw'Options must be provided to generate Intake Object';if(this.Options=g,g instanceof DateIntakeOptions)this.BaseIntake=new DateIntake(this,d);else if(g instanceof PhoneIntakeOptions)this.BaseIntake=new PhoneIntake(this,d);else if(g instanceof ZipCodeIntakeOptions)this.BaseIntake=new ZipCodeIntake(this,d);else throw'Unrecognized options provided';this.Callback=h}return _createClass(a,[{key:'Destroy',value:function Destroy(){for(;this.Container.firstChild;)this.Container.removeChild(this.Container.firstChild)}}]),a}(),DateIntakeOptions=function a(b,c){_classCallCheck(this,a),this.Format=b,this.Divider=c},PhoneIntakeOptions=function a(b){var c=1<arguments.length&&arguments[1]!==void 0?arguments[1]:' ';_classCallCheck(this,a),this.Format=b,this.PlaceHolderCharacter=c.substr(0,1)},ZipCodeIntakeOptions=function a(){var b=0<arguments.length&&arguments[0]!==void 0?arguments[0]:null,c=1<arguments.length&&arguments[1]!==void 0?arguments[1]:null,d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;_classCallCheck(this,a),this.Country=b,this.IsNumeric=c,this.MaxLength=d},IntakeBase=function(){function a(b,c){if(_classCallCheck(this,a),this.Parent=b,this.GeneratePartGroup(),this.IntakeParts=[],!this.GenerateIntakeParts)throw'BaseIntake.GenerateIntakeParts() not implemented by SubClass';if(this.GenerateIntakeParts(),!this.PopulateFromExistingValue)throw'BaseIntake.PopulateFromExistingValue(value) not implemented by SubClass';this.PopulateFromExistingValue(c),this.GenerateBtnClear();var d=this;this.BtnClear&&(this.BtnClear.onclick=function(){d.Clear()}),this.Parent.Form&&(this.Parent.Form.onsubmit=function(){d.UpdateHiddenInputWithFormattedValue?d.UpdateHiddenInputWithFormattedValue():d.UpdateHiddenInputWithRawValue()}),this.Parent.Container.onblur=function(){d.IntakeParts.forEach(function(f){f instanceof IntakeInput&&(f.TrimToMaxLength(),d.Parent.Callback&&d.Parent.Callback())})}}return _createClass(a,[{key:'GeneratePartGroup',value:function GeneratePartGroup(){var b=document.createElement('div');b.className='Intake-PartGroup',this.PartGroup=b,this.Parent.Container.appendChild(b)}},{key:'GenerateBtnClear',value:function GenerateBtnClear(){var b=document.createElement('i');b.className='fas fa-times-circle Intake-BtnClear',this.BtnClear=b,this.Parent.Container.appendChild(b)}},{key:'Clear',value:function Clear(){this.IntakeParts.forEach(function(b){b instanceof IntakeInput&&b.Clear()})}},{key:'UpdateHiddenInputWithRawValue',value:function UpdateHiddenInputWithRawValue(){this.Parent.HiddenInput&&(this.Parent.HiddenInput.value=this.GetRawValue(),this.FireChangeEvent(this.Parent.HiddenInput))}},{key:'FireChangeEvent',value:function FireChangeEvent(b){if(!document.createEventObject){var c=document.createEvent('HTMLEvents');return c.initEvent('change',!0,!0),!b.dispatchEvent(c)}return b.fireEvent('onchange',document.createEventObject())}},{key:'IsEmpty',value:function IsEmpty(b){return''==b}},{key:'GetRawValue',value:function GetRawValue(){var b='';return this.IntakeParts.forEach(function(c){c instanceof IntakeInput&&(b+=c.Element.value)}),b}},{key:'GetFirstEmptyIntakeInput',value:function GetFirstEmptyIntakeInput(){var b=null;return this.IntakeParts.some(function(c){if(c instanceof IntakeInput)return c.IsEmpty()&&(b=c),!0}),b}}]),a}(),DateIntake=function(a){function b(c,d){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c,d))}return _inherits(b,a),_createClass(b,[{key:'GenerateIntakeParts',value:function GenerateIntakeParts(){for(var h=this,c=this.Parent.Options.Divider,d=this.Parent.Options.Format.split(c),f=['paste'],g=0;g<d.length;g++)this.IntakeParts.push(new NumberIntakeInput(this,d[g],f,d[g])),g!=d.length-1&&this.IntakeParts.push(new IntakeDivider(this,c));this.IntakeParts[0].Element.style.marginLeft='2px',this.IntakeParts.forEach(function(k){h.PartGroup.appendChild(k.Element),k.Element.style.textAlign='left',k.Element.style.paddingLeft='4px'});for(var j=0;j<this.IntakeParts.length;j++)this.IntakeParts[j]instanceof IntakeInput&&(j+2<=this.IntakeParts.length&&(this.IntakeParts[j].NextPart=this.IntakeParts[j+2]),0<=j-2&&(this.IntakeParts[j].PreviousPart=this.IntakeParts[j-2]))}},{key:'PopulateFromExistingValue',value:function PopulateFromExistingValue(c){if(''!=c){var d=[];this.IntakeParts.forEach(function(h){h instanceof IntakeInput&&d.push(h)});var f=c.split(this.Parent.Options.Divider);if(d.length&&f)for(var g=0;g<d.length;g++)d[g].Element.value=f[g]}}},{key:'UpdateHiddenInputWithFormattedValue',value:function UpdateHiddenInputWithFormattedValue(){this.Parent.HiddenInput&&(this.Parent.HiddenInput.value=this.GetFormattedValue(),this.FireChangeEvent(this.Parent.HiddenInput))}},{key:'GetFormattedValue',value:function GetFormattedValue(){var c=[],d=!0;if(this.IntakeParts.forEach(function(g){g instanceof IntakeInput&&(c.push(g.Element.value),d=d&&g.IsComplete())}),d){var f=this.Parent.Options.Divider;return c[0]+f+c[1]+f+c[2]}return''}}]),b}(IntakeBase),PhoneIntake=function(a){function b(c,d){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c,d))}return _inherits(b,a),_createClass(b,[{key:'GenerateIntakeParts',value:function GenerateIntakeParts(){var f=this,c=['paste'],d=this.Parent.Options.PlaceHolderCharacter;if('(XXX)XXX-XXXX'===this.Parent.Options.Format)this.IntakeParts.push(new IntakeDivider(this,'(')),this.IntakeParts.push(new NumberIntakeInput(this,d.repeat(3),c)),this.IntakeParts.push(new IntakeDivider(this,')')),this.IntakeParts.push(new NumberIntakeInput(this,d.repeat(3),c)),this.IntakeParts.push(new IntakeDivider(this,'-')),this.IntakeParts.push(new NumberIntakeInput(this,d.repeat(4),c)),this.IntakeParts[1].NextPart=this.IntakeParts[3],this.IntakeParts[3].NextPart=this.IntakeParts[5],this.IntakeParts[3].PreviousPart=this.IntakeParts[1],this.IntakeParts[5].PreviousPart=this.IntakeParts[3];else if('XXX-XXX-XXX'===this.Parent.Options.Format)this.IntakeParts.push(new NumberIntakeInput(this,d.repeat(3),c)),this.IntakeParts.push(new IntakeDivider(this,'-')),this.IntakeParts.push(new NumberIntakeInput(this,d.repeat(3),c)),this.IntakeParts.push(new IntakeDivider(this,'-')),this.IntakeParts.push(new NumberIntakeInput(this,d.repeat(4),c)),this.IntakeParts[0].NextPart=this.IntakeParts[2],this.IntakeParts[2].NextPart=this.IntakeParts[4],this.IntakeParts[2].PreviousPart=this.IntakeParts[0],this.IntakeParts[4].PreviousPart=this.IntakeParts[2];else throw'Invalid format provided with PhoneIntakeOptions.';this.IntakeParts[0].Element.style.marginLeft='2px',this.IntakeParts.forEach(function(g){f.PartGroup.appendChild(g.Element),g.Element.style.textAlign='left'})}},{key:'PopulateFromExistingValue',value:function PopulateFromExistingValue(c){this.IntakeParts[1].Element.value=c.substr(0,3),this.IntakeParts[3].Element.value=c.substr(3,3),this.IntakeParts[5].Element.value=c.substr(6,4)}}]),b}(IntakeBase),ZipCodeIntake=function(a){function b(c,d){_classCallCheck(this,b);var f=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c,d));return f.Parent.Container.onclick=function(){f.IntakeParts[0].Element.focus()},f}return _inherits(b,a),_createClass(b,[{key:'GenerateIntakeParts',value:function GenerateIntakeParts(){var d,f=this,c=['paste'];if(this.Parent.Options.Country)switch(this.Parent.Options.Country){case'USA':d=new NumberIntakeInput(this,'     ',c);break;case'Canada':d=new TextIntakeInput(this,'      ',c);break;default:throw'Unrecognized Country Provided for ZipCodeIntakeOptions';}else if(!this.Parent.Options.MaxLength)throw'MaxLength must be provided when Country is ommitted from ZipCodeIntakeOptions';else d=this.Parent.Options.IsNumeric?new NumberIntakeInput(this,' '.repeat(this.Parent.Options.MaxLength),c):new TextIntakeInput(this,' '.repeat(this.Parent.Options.MaxLength),c);this.IntakeParts.push(d),this.IntakeParts.forEach(function(g){f.PartGroup.appendChild(g.Element)})}},{key:'PopulateFromExistingValue',value:function PopulateFromExistingValue(c){this.IntakeParts[0].Element.value=c,this.IntakeParts[0].TrimToMaxLength()}}]),b}(IntakeBase),IntakePartBase=function a(b,c,d){_classCallCheck(this,a),this.Parent=b,this.MaxLength=c,this.Element=document.createElement(d),this.UpdateWidth()},IntakeInput=function(a){function b(c,d,f){var h=3<arguments.length&&void 0!==arguments[3]?arguments[3]:'text',j=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null;_classCallCheck(this,b);var g=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c,j?j:d.length,'input'));return g.PlaceHolder=d,g.Element.className='Intake-Part',g.Element.setAttribute('placeholder',g.PlaceHolder),g.Element.setAttribute('type',h),g.EventsToPrevent=f,g.InitializeListeners(),g.JustGainedFocus=!1,g}return _inherits(b,a),_createClass(b,[{key:'UpdateWidth',value:function UpdateWidth(){this.Element.style.width=this.Element.value&&''!=this.Element.value?7.7*(this.Element.value.length+2)+'px':7.7*(this.MaxLength+3)+'px'}},{key:'InitializeListeners',value:function InitializeListeners(){var d=this;this.EventsToPrevent.forEach(function(f){d.Element.addEventListener(f,function(g){c.PreventDefault(g)})});var c=this;if(!this.KeyUp)throw'BaseIntakePart.KeyUp(event) not implemented by SubClass';if(!this.KeyDown)throw'BaseIntakePart.KeyDown(event) not implemented by SubClass';this.Element.onkeyup=function(f){c.KeyUp(f)},this.Element.onkeydown=function(f){c.KeyDown(f)},this.Element.onclick=function(){var g=c.Parent.GetFirstEmptyIntakeInput();g&&g.Element?g.Element.focus():this.focus()},this.Element.onfocus=function(){c.JustGainedFocus=!0},this.Element.onblur=function(){c.TrimToMaxLength(),c.UpdateWidth(),c.Parent.Parent.Callback&&c.Parent.Parent.Callback()}}},{key:'PreventDefault',value:function PreventDefault(c){c.preventDefault()}},{key:'KeyTypeFromEvent',value:function KeyTypeFromEvent(c){var d=c.which||c.keyCode;if(!c.shiftKey){if(8==d)return'Backspace';if(9==d)return'Tab';if(37==d)return'LeftArrow';if(38==d)return'UpArrow';if(39==d)return'RightArrow';if(40==d)return'DownArrow';if(46==d)return'Delete';if(48<=d&&57>=d||96<=d&&105>=d)return'Number';if(229==d)return'Android'}else if(9==d)return'Shift+Tab';return''}},{key:'GoToPrevious',value:function GoToPrevious(){this.PreviousPart&&this.PreviousPart.Element&&this.PreviousPart.Element.focus()}},{key:'GoToNext',value:function GoToNext(){this.NextPart&&this.NextPart.Element&&this.NextPart.Element.focus()}},{key:'IsEmpty',value:function IsEmpty(){return!this.Element.value||''==this.Element.value}},{key:'IsAtBegginingOfInput',value:function IsAtBegginingOfInput(){return 0==this.Element.selectionEnd}},{key:'IsAtEndOfInput',value:function IsAtEndOfInput(){return this.Element.value.length==this.Element.selectionEnd}},{key:'IsComplete',value:function IsComplete(){return this.Element.value.length>=this.MaxLength}},{key:'IsValueHighlighted',value:function IsValueHighlighted(){var c='';return window.getSelection?c=window.getSelection().toString():document.selection&&'Control'!=document.selection.type&&(c=document.selection.createRange().text),c==this.Element.value}},{key:'TrimToMaxLength',value:function TrimToMaxLength(){var c=this.Element.value,d=c.substring(0,this.MaxLength);this.Element.value=d}},{key:'Clear',value:function Clear(){this.Element.value='',this.UpdateWidth()}},{key:'KeyDown',value:function KeyDown(){this.JustGainedFocus=!1}},{key:'KeyUp',value:function KeyUp(){this.TrimToMaxLength(),this.Parent.UpdateHiddenInputWithFormattedValue?this.Parent.UpdateHiddenInputWithFormattedValue():this.Parent.UpdateHiddenInputWithRawValue()}}]),b}(IntakePartBase),NumberIntakeInput=function(a){function b(c,d,f){var h=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;_classCallCheck(this,b);var g=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c,d,f,'number',null));return g.Element.min=0,g.Element.pattern='[0-9]*',g.Element.setAttribute('inputmode','numeric'),g.Element.value=h,g}return _inherits(b,a),_createClass(b,[{key:'KeyDown',value:function KeyDown(c){switch(_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'KeyDown',this).call(this,c),this.KeyTypeFromEvent(c)){case'Shift+Tab':this.PreviousPart&&(this.GoToPrevious(),c.preventDefault());break;case'UpArrow':case'DownArrow':c.preventDefault();break;case'Tab':this.NextPart&&(this.GoToNext(),c.preventDefault());break;case'LeftArrow':this.PreviousPart&&(this.IsEmpty()||this.IsAtBegginingOfInput())&&(this.GoToPrevious(),c.preventDefault());break;case'RightArrow':this.NextPart&&(this.IsEmpty()||this.IsAtEndOfInput())&&(this.GoToNext(),c.preventDefault());break;case'Delete':break;case'Backspace':this.IsEmpty()&&this.GoToPrevious();break;case'Number':this.IsComplete()&&!this.IsValueHighlighted()&&c.preventDefault();break;default:c.preventDefault();}}},{key:'KeyUp',value:function KeyUp(c){switch(this.KeyTypeFromEvent(c)){case'Shift+Tab':case'LeftArrow':case'Tab':case'RightArrow':break;case'Backspace':this.IsEmpty()&&this.UpdateWidth();break;case'Android':case'Number':this.IsComplete()&&!this.IsValueHighlighted()&&(!this.JustGainedFocus&&this.GoToNext(),c.preventDefault());}_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'KeyUp',this).call(this,c)}}]),b}(IntakeInput),TextIntakeInput=function(a){function b(c,d,f){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c,d,f,'text',null))}return _inherits(b,a),_createClass(b,[{key:'KeyDown',value:function KeyDown(c){switch(_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'KeyDown',this).call(this,c),this.KeyTypeFromEvent(c)){case'Shift+Tab':this.PreviousPart&&(this.GoToPrevious(),c.preventDefault());break;case'UpArrow':case'DownArrow':c.preventDefault();break;case'Tab':this.NextPart&&(this.GoToNext(),c.preventDefault());break;case'LeftArrow':this.PreviousPart&&(this.IsEmpty()||this.IsAtBegginingOfInput())&&(this.GoToPrevious(),c.preventDefault());break;case'RightArrow':this.NextPart&&(this.IsEmpty()||this.IsAtEndOfInput())&&(this.GoToNext(),c.preventDefault());break;case'Delete':break;case'Backspace':this.IsEmpty()&&this.GoToPrevious();break;default:this.IsComplete()&&!this.IsValueHighlighted()&&c.preventDefault();}}},{key:'KeyUp',value:function KeyUp(c){switch(this.KeyTypeFromEvent(c)){case'Shift+Tab':case'LeftArrow':case'Tab':case'RightArrow':case'Backspace':break;default:this.IsComplete()&&!this.IsValueHighlighted()&&(!this.JustGainedFocus&&this.GoToNext(),c.preventDefault());}_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'KeyUp',this).call(this,c)}}]),b}(IntakeInput),IntakeDivider=function(a){function b(c,d){_classCallCheck(this,b);var f=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c,d.length,'p'));return f.Element.className='Intake-Part',f.Element.innerText=d,f}return _inherits(b,a),_createClass(b,[{key:'UpdateWidth',value:function UpdateWidth(){this.Element.style.width=7.2*this.MaxLength+'px'}}]),b}(IntakePartBase);